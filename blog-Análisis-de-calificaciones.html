<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>El Rincón De Los Datos</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="" name="keywords">
  <meta content="" name="description">

  <!-- Favicons -->
  <link href="img/favicon.png" rel="icon">
  <link href="img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Bootstrap CSS File -->
  <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Libraries CSS Files -->
  <link href="lib/font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <link href="lib/animate/animate.min.css" rel="stylesheet">
  <link href="lib/ionicons/css/ionicons.min.css" rel="stylesheet">
  <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
  <link href="lib/lightbox/css/lightbox.min.css" rel="stylesheet">

  <!-- Main Stylesheet File -->
  <link href="css/style.css" rel="stylesheet">


</head>

<body>
  <!--/ Nav Star /-->
  <nav class="navbar navbar-b navbar-trans navbar-expand-md fixed-top" id="mainNav">
    <div class="container">
      <a class="navbar-brand js-scroll" href="index.html#home">Christian Altamirano</a>
      <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarDefault"
        aria-controls="navbarDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <div class="navbar-collapse collapse justify-content-end" id="navbarDefault">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link js-scroll" href="index.html#home">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll" href="index.html#about">Sobre mí</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll" href="index.html#service">Intereses</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll" href="index.html#work">Proyectos</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll" href="#blog">Blog</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll" href="index.html#contact">Contacto</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <!--/ Nav End /-->

  <!--/ Intro Skew Star /-->
  <div class="intro intro-single route bg-image" style="background-image: url(img/overlay-bg.jpg)">
    <div class="overlay-mf"></div>
    <div class="intro-content display-table">
      <div class="table-cell">
        <div class="container">
          <h2 class="intro-title mb-4">El Rincón De Los Datos</h2>
          <ol class="breadcrumb d-flex justify-content-center">
            <li class="breadcrumb-item active">Otros posts</li>
            <li class="breadcrumb-item active">Proyecto</li>
            <li class="breadcrumb-item active">Paso a paso</li>
          </ol>
        </div>
      </div>
    </div>
  </div>
  <!--/ Intro Skew End /-->

  <!--/ Section Blog-Single Star /-->
  <section class="blog-wrapper sect-pt4" id="blog">
    <div class="container">
      <div class="row">
        <div class="col-md-8">
          <div class="post-box">
            <div class="post-thumb">
              <img src="img/proyecto1.jpg" class="img-fluid" alt="">
            </div>
            <div class="post-meta">
              <h1 class="article-title">Análisis de calificaciones</h1>
              <ul>
                <li>
                  <span class="ion-pricetag"></span>
                  <a href="#">Python 3</a>
                </li>
                <li>
                  <span class="ion-ios-monitor-outline"></span>
                  Tutorial
                </li>
              </ul>
            </div>
            <div class="article-content">
              <p>
                En este post vamos a realizar un ejercicio de análisis completo. Para empezar asegúrate de tener una
                consola con python 3, un IDE, un notebook de google colab o tu editor de código favorito listo con las
                siguientes librerías: Pandas, Numpy, Matplotlib, Seaborn, Sklearn, Keras y Tensorflow2.
              </p>
              <p>Primero cargamos las librerías:</p>
              <div class="highlight">
                <span class="rosa">import</span>
                <span class="verde">pandas</span>
                <span class="rosa">as</span>
                <span class="verde">pd</span>
                <br>
                <span class="rosa">import</span>
                <span class="verde">matplotlib.pyplot</span>
                <span class="rosa">as</span>
                <span class="verde">plt</span>
                <br>
                <span class="rosa">import</span>
                <span class="verde">keras</span>
                <span class="rosa">as</span>
                <span class="verde">keras</span>
                <br>
                <span class="rosa">import</span>
                <span class="verde">numpy</span>
                <span class="rosa">as</span>
                <span class="verde">np</span>
                <br>
                <span class="rosa">import</span>
                <span class="verde">seaborn</span>
                <span class="rosa">as</span>
                <span class="verde">sns</span>
                <br>
                <span class="rosa">import</span>
                <span class="verde">tensorflow</span>
                <span class="rosa">as</span>
                <span class="verde">tf</span>
                <br>
                <span class="rosa">from</span>
                <span class="verde">keras</span>
                <span class="rosa">import</span>
                <span class="verde">layers</span>
                <br>
                <span class="rosa">from</span>
                <span class="verde">sklearn.ensemble</span>
                <span class="rosa">import</span>
                <span class="verde">RandomForestRegressor</span>
                <br>
                <span class="rosa">from</span>
                <span class="verde">sklearn.metrics</span>
                <span class="rosa">import</span>
                <span class="verde">mean_squared_error</span>
                <br>
                <span class="rosa">from</span>
                <span class="verde">sklearn.model_selection</span>
                <span class="rosa">import</span>
                <span class="verde">train_test_split</span>
                <br>
                <span class="rosa">from</span>
                <span class="verde">sklearn.svm</span>
                <span class="rosa">import</span>
                <span class="verde">SVR</span>
              </div>
              <p>
                Una vez hecho esto ya podemos cargar los datos, los guardaremos en una variable llamada "data" (los
                datos los puedes descargar en la sección "Material descargable" en la parte inferior de esta página,
                simplemente da clic en el enlace).
              </p>
              <div class="highlight">
                <span class="azul">data</span>
                <span class="blanco">=</span>
                <span class="verde">pd.read_csv</span>(<span class="n">'.../calificaciones-de-matematicas.csv'</span>)
              </div>
              <p>
                Echemos un vistazo rápido a los datos. Empezamos viendo los primeros 5 casos (filas).
              </p>
              <div class="highlight">
                <span class="azul">data</span>.<span class="n">head</span>()
              </div>
              <p>
                También revisemos las dimensiones de los datos (cuantas filas y columnas existen).
              </p>
              <div class="highlight">
                <span class="azul">data</span>.<span class="azul">shape</span>
              </div>
              <p>
                Como podrás ver en los resultados (si estás siguiendo el tutorial), existe información de 395
                estudiantes dividida en 33 columnas. Encontremos los nombres de todas las variables (columnas) de
                información.
              </p>
              <div class="highlight">
                <span class="azul">data</span>.<span class="azul">columns</span>
              </div>
              <p>
                Muy bien, ahora algo de información, existen 33 columnas, las cuales son:
              </p>
              <p>
                <strong>•'school' o escuela:</strong> que es la escuela del estudiante, es una variable binaria que
                puede ser 'GP' (Gabriel Pereira) o 'MS' (Mousinho da Silveira).
              </p>
              <p>
                <strong>•'sex' o sexo:</strong> es el sexo del estudiante, es una variable binaria que puede ser "F"
                (mujer) o "M" (hombre).
              </p>
              <p>
                <strong>•'age' o edad:</strong> es la edad del estudiante, es una variable numérica con valores entre 15
                y 22 años.
              </p>
              <p>
                <strong>•'address' o dirección:</strong> es el tipo de domicilio del estudiante, es una variable binaria
                que puede ser "U" (urbano) o "R" (rural).
              </p>
              <p>
                <strong>•'famsize' o tamaño de la familia:</strong> es una variable binaria que puede ser "LE3" (menos o
                igual a 3) o "GT3" (más de 3).
              </p>
              <p>
                <strong>•'Pstatus' o estado de convivencia de los padres:</strong> es una variable binaria que puede ser
                "T" (convivencia) o "A" (separación).
              </p>
              <p>
                <strong>•'Medu' o educación de la madre:</strong> es una variable numérica que puede ser 0 (ninguna),1
                (educación primaria),2 (de 5º a 9º grado),3 (educación secundaria) y 4 (educación superior).
              </p>
              <p>
                <strong>•'Fedu' o educación del padre:</strong> es una variable numérica que puede ser 0 (ninguna),1
                (educación primaria),2 (de 5º a 9º grado),3 (educación secundaria) y 4 (educación superior).
              </p>
              <p>
                <strong>•'Mjob' o trabajo de la madre:</strong> es una variable categorica que puede ser 'profesor',
                'relacionado con la salud', 'servicios', 'en_casa' u 'otro'.
              </p>
              <p>
                <strong>•'Fjob' o trabajo del padre:</strong> es una variable categorica que puede ser 'profesor',
                'relacionado con la salud', 'servicios', 'en_casa' u 'otro'.
              </p>
              <p>
                <strong>•'reason' o razón:</strong> razón para elegir este centro, es una variable categorica que puede
                ser 'casa' (cerca del hogar), 'reputación' (del centro), 'curso' (de preferencia) u 'otro'.
              </p>
              <p>
                <strong>•'guardian' o tutor:</strong> tutor del alumno, es una variable categorica que puede ser
                "madre", "padre" u "otro").
              </p>
              <p>
                <strong>•'traveltime' o tiempo de viaje de casa a la escuela:</strong> es una variable numérica que
                puede ser 1 (<15 min.), 2 (15 a 30 min.), 3 (de 30 min. a 1 hora), o 4 (>1 hora).
              </p>
              <p>
                <strong>•'studytime' o tiempo de estudio:</strong> es el tiempo de estudio semanal, es una variable
                numérica que puede ser 1 (<2 horas), 2 (de 2 a 5 horas), 3 (de 5 a 10 horas), o 4 (>10 horas).
              </p>
              <p>
                <strong>•'failures' o fracasos:</strong> número de fracasos de clase en el pasado, es una variable que
                puede estar entre 0 y 4.
              </p>
              <p>
                <strong>•'schoolsup' o apoyo educativo adicional:</strong> es una variable binaria que puede ser "sí" o
                "no".
              </p>
              <p>
                <strong>•'famsup' o apoyo educativo familiar:</strong> es una variable binaria que puede ser "sí" o
                "no".
              </p>
              <p>
                <strong>•'paid' o clases extra pagadas:</strong> clases extra pagadas dentro de la asignatura del curso
                (matemáticas o portugués), es una variable binaria que puede ser "sí" o "no".
              </p>
              <p>
                <strong>•'activities' o actividades:</strong> actividades extraescolares, es una variable binaria que
                puede ser "sí" o "no".
              </p>
              <p>
                <strong>•'nursery' o guardería:</strong> asistió a la guardería, es una variable binaria que puede ser
                "sí" o "no".
              </p>
              <p>
                <strong>•'higher' o superior:</strong> quiere cursar estudios superiores, es una variable binaria que
                puede ser "sí" o "no".
              </p>
              <p>
                <strong>•'internet' o acceso a Internet:</strong> posee acceso a Internet en casa, es una variable
                binaria que puede ser "sí" o "no".
              </p>
              <p>
                <strong>•'romantic' o romántico:</strong> tiene una relación romántica, es una variable binaria que
                puede ser "sí" o "no".
              </p>
              <p>
                <strong>•'famrel' o relaciones familiares:</strong> calidad de las relaciones familiares, es una
                variable numérica entre 1 (muy malo) y 5 (excelente).
              </p>
              <p>
                <strong>•'freetime' o tiempo libre:</strong> tiempo libre después de la escuela, es una variable
                numérica entre 1 (muy bajo) y 5 (muy alto).
              </p>
              <p>
                <strong>•'goout' o salir:</strong> salir con amigos, es una variable numérica entre 1 (muy bajo) y 5
                (muy alto).
              <p>
                <strong>•'Dalc' o alcohol entre semana:</strong> consumo de alcohol en el día de trabajo, es una
                variable numérica entre 1 (muy bajo) y 5 (muy alto).
              </p>
              <p>
                <strong>•'Walc' o alcohol el fin de semana:</strong> consumo de alcohol en fin de semana, es una
                variable numérica entre 1 (muy bajo) y 5 (muy alto).
              </p>
              <p>
                <strong>•'health' o salud:</strong> estado de salud actual, es una variable numérica entre 1 (muy bajo)
                y 5 (muy alto).
              </p>
              <p>
                <strong>•'absences' o ausencias:</strong> número de ausencias escolares, es una variable numérica entre
                0 y 93.
              </p>
              <p>
                <strong>•'G1' o calificación 1:</strong> calificación del primer período, es una variable numérica entre
                0 y 20.
              </p>
              <p>
                <strong>•'G2' o calificación 2:</strong> calificación del segundo período, es una variable numérica
                entre 0 y 20.
              </p>
              <p>
                <strong>•'G3' o calificación 3:</strong> calificación final, es una variable numérica entre 0 y 20.
              </p>
              <p>
                Una vez teniendo esto en cuenta vamos a empezar el análisis. Nuestro objetivo es predecir la
                calificación final (G3) de los alumnos, por ello se empezará analizando esa variable:
              </p>
              <div class="highlight">
                <span class="azul">data</span>[<span class="n">'G3'</span>].<span class="n">describe</span>()
              </div>
              <p>
                Existen 395 calificaciones finales, el promedio de calificaciones finales es 10.42 con una desviación
                estándar de 4.6, la calificación más baja es 0.
              </p>
              <p>
                Grafiquemos la variable calificación final (G3) con un histograma:
              </p>
              <div class="highlight">
                <span class="azul">target</span> =
                <span class="n">sns</span>.
                <span class="rosa">countplot</span>(<span class="azul">x</span>=<span class="n">'G3'</span>, <span
                  class="azul">data</span> = <span class="azul">data</span>)
                <br>
                <span class="azul">target</span>.<span class="n">axes</span>.<span class="n">set_title</span>(<span
                  class="azul">'Histograma de calificaciones finales'</span>, <span class="azul">fontsize</span> = <span
                  class="n">20</span>)
                <br>
                <span class="azul">target</span>.<span class="n">set_ylabel</span>(<span
                  class="azul">'Frecuencia'</span>, <span class="azul">fontsize</span> = <span class="n">20</span>)
                <br>
                <span class="azul">target</span>.<span class="n">set_xlabel</span>(<span class="azul">'Calificación
                  final'</span>, <span class="azul">fontsize</span> = <span class="n">20</span>)
                <br>
                <span class="azul">plt</span>.<span class="n">show</span>()
              </div>
              <div class="image">
                <img src="img/tutorial1_1.png""
                  alt=" histograma" width="100%">
              </div>
              <p>
                En este histograma podemos observar que la calificación final es una variable continua, por lo que
                podemos hacer una regresión lineal. Sin embargo, vamos a usar algoritmos más avanzado para predecir en
                este caso. Utilizaremos un modelo de máquinas de soporte de vectores de regresión o SVR, un modelo de
                árboles como el Random Forest para regresión y para finalizar, una red neuronal para regresión.
              </p>
              <p>
                Primero revisemos que no existan valores nulos en las variables:
              </p>
              <div class="highlight">
                <span class="azul">data</span>.<span class="n">isnull</span>().<span class="n">any</span>()
              </div>
              <p>
                No hay valores nulos, por lo que podemos continuar con el análisis. Vamos a Separar a los estudiantes
                por sexo:
              </p>
              <div class="highlight">
                <span class="azul">students_m</span> = <span class="n">len</span>(<span class="azul">data</span>[<span
                  class="azul">data</span>[<span class="n">'sex'</span>] == <span class="n">'M'</span>])
                <br>
                <span class="azul">students_f</span> = <span class="n">len</span>(<span class="azul">data</span>[<span
                  class="azul">data</span>[<span class="n">'sex'</span>] == <span class="n">'F'</span>])
              </div>
              <p>
                Ahora vamos a hacer un gráfico de los estudiantes por sexo y por edad, para ver su distribución:
              </p>
              <div class="highlight">
                <span class="azul">sex_students</span> =
                <span class="verde">sns</span>.
                <span class="rosa">countplot</span>(<span class="azul">x</span> = <span class="n">'age'</span>,
                <span class="azul">hue</span> = <span class="n">'sex'</span>, <span class="azul">data</span> =
                <span class="azul">data</span>)
                <br>
                <span class="azul">sex_students</span>.<span class="n">axes</span>.<span class="verde">set_title</span>(
                <span class="n">'Grupos por edad'</span>, <span class="azul">fontsize</span> = <span
                  class="azul">30</span>)
                <br>
                <span class="azul">sex_students</span>.<span class="n">set_xlabel</span>(<span class="n">'Edad'</span>,
                <span class="azul">fontsize</span> = <span class="n">20</span>)
                <br>
                <span class="azul">sex_students</span>.<span class="n">set_ylabel</span>(<span
                  class="n">'Estudiantes'</span>,
                <span class="azul">fontsize</span> = <span class="n">20</span>)
                <br>
                <span class="azul">sex_students</span>.<span class="verde">legend</span>([<span
                  class="n">'Mujeres'</span>,
                <span class="n">'Hombres'</span>], <span class="azul">loc</span> = <span class="n">'upper right'</span>)
                <br>
                <span class="verde">plt</span>.<span class="n">show</span>()
              </div>
              <div class="image">
                <img src="img/tutorial1_2.png""
                  alt=" histograma" width="100%">
              </div>
              <p>
                En este gráfico podemos observar que hay una distribución muy similar entre las mujeres y las
                hombres. Sin embargo, hay una distribución más dispersa en la edad de los estudiantes. Para observar
                mejor como se relacionan las variables, revisemos las correlaciones de las variables numéricas con la
                variable objetiva:
              </p>
              <div class="highlight">
                <span class="azul">data</span>.<span class="n">corr</span>()[<span class="n">'G3'</span>].<span
                  class="verde">sort_values</span>(<span class="azul">ascending</span> = <span
                  class="azul">False</span>)
              </div>
              <p>
                Aquí podemos ver que las variables que más correlacionan con la calificación final son las
                calificaciones anteriores de los estudiantes. Las siguientes variables por correlación son los
                fracasos escolares anteriores y luego variables de educación de los padres (madre y padre). Vamos a
                borrar la variable del nombre de la escuela, dado que al ser un set desbalanceado es una variable que no
                aporta mucho y puede ser potencialmente ruidosa:
              </p>
              <div class="highlight">
                <span class="azul">data</span>.<span class="n">drop</span>([<span class="n">'school'</span>],
                <span class="azul">axis</span> = <span class="n">1</span>, <span class="verde">inplace</span> =
                <span class="azul">True</span>)
              </div>
              <p>
                Ahora se puede empezar la preparación de los datos para los algoritmos de aprendizaje, primero se va a
                cambiar el nombre del conjunto de datos para que represente a todos los datos. A continuación, se van a
                cambiar los valores de las variables categóricas por valores numéricos:
              </p>
              <div class="highlight">
                <span class="azul">data_total</span> = <span class="azul">data</span>.<span class="n">copy</span>()
                <br>
                <span class="azul">categorical_d</span> = {<span class="n">'yes'</span>: <span class="verde">1</span>,
                <span class="n">'no'</span>: <span class="verde">0</span>}
                <br>
                <br>
                <span class="azul">data_total</span>[<span class="n">'schoolsup'</span>] = <span
                  class="azul">data_total</span>[
                <span class="n">'schoolsup'</span>].<span class="verde">map</span>(<span
                  class="azul">categorical_d</span>)
                <br>
                <span class="azul">data_total</span>[<span class="n">'famsup'</span>] = <span
                  class="azul">data_total</span>[
                <span class="n">'famsup'</span>].<span class="verde">map</span>(<span class="azul">categorical_d</span>)
                <br>
                <span class="azul">data_total</span>[<span class="n">'paid'</span>] = <span
                  class="azul">data_total</span>[
                <span class="n">'paid'</span>].<span class="verde">map</span>(<span class="azul">categorical_d</span>)
                <br>
                <span class="azul">data_total</span>[<span class="n">'activities'</span>] = <span
                  class="azul">data_total</span>[
                <span class="n">'activities'</span>].<span class="verde">map</span>(<span
                  class="azul">categorical_d</span>)
                <br>
                <span class="azul">data_total</span>[<span class="n">'nursery'</span>] = <span
                  class="azul">data_total</span>[
                <span class="n">'nursery'</span>].<span class="verde">map</span>(<span
                  class="azul">categorical_d</span>)
                <br>
                <span class="azul">data_total</span>[<span class="n">'higher'</span>] = <span
                  class="azul">data_total</span>[
                <span class="n">'higher'</span>].<span class="verde">map</span>(<span class="azul">categorical_d</span>)
                <br>
                <span class="azul">data_total</span>[<span class="n">'internet'</span>] = <span
                  class="azul">data_total</span>[
                <span class="n">'internet'</span>].<span class="verde">map</span>(<span
                  class="azul">categorical_d</span>)
                <br>
                <span class="azul">data_total</span>[<span class="n">'romantic'</span>] = <span
                  class="azul">data_total</span>[
                <span class="n">'romantic'</span>].<span class="verde">map</span>(<span
                  class="azul">categorical_d</span>)
              </div>
              <p>
                Esas fueron las variables binarias que se pudieron cambiar un 'yes' o 'no' por un 1 o 0. Ahora vamos a
                cambiar las demás variables categóricas que tienen otros valores:
              </p>
              <div class="highlight">
                <span class="azul">categorical_d</span> = {<span class="n">'F'</span>: <span class="verde">1</span>,
                <span class="n">'M'</span>: <span class="verde">0</span>}
                <br>
                <span class="azul">data_total</span>[<span class="n">'sex'</span>] = <span
                  class="azul">data_total</span>[<span class="n">'sex'</span>].<span class="n">map</span>(
                <span class="azul">categorical_d</span>)
                <br>
                <br>
                <span class="azul">categorical_d</span> = {<span class="n">'U'</span>: <span class="verde">1</span>,
                <span class="n">'R'</span>: <span class="verde">0</span>}
                <br>
                <span class="azul">data_total</span>[<span class="n">'address'</span>] = <span
                  class="azul">data_total</span>[<span class="n">'address'</span>].<span class="n">map</span>(
                <span class="azul">categorical_d</span>)
                <br>
                <br>
                <span class="azul">categorical_d</span> = {<span class="n">'LE3'</span>: <span class="verde">1</span>,
                <span class="n">'GT3'</span>: <span class="verde">0</span>}
                <br>
                <span class="azul">data_total</span>[<span class="n">'famsize'</span>] = <span
                  class="azul">data_total</span>[<span class="n">'famsize'</span>].<span class="n">map</span>(
                <span class="azul">categorical_d</span>)
                <br>
                <br>
                <span class="azul">categorical_d</span> = {<span class="n">'T'</span>: <span class="verde">1</span>,
                <span class="n">'A'</span>: <span class="verde">0</span>}
                <br>
                <span class="azul">data_total</span>[<span class="n">'Pstatus'</span>] = <span
                  class="azul">data_total</span>[<span class="n">'Pstatus'</span>].<span class="n">map</span>(
                <span class="azul">categorical_d</span>)
                <br>
                <br>
                <span class="azul">categorical_d</span> = {<span class="n">'teacher'</span>: <span
                  class="verde">0</span>,
                <span class="n">'health'</span>: <span class="verde">1</span>, <span class="n">'services'</span>: <span
                  class="verde">2</span>,<span class="n">'at_home'</span>: <span class="verde">3</span>,
                <span class="n">'other'</span>: <span class="verde">4</span>}
                <br>
                <span class="azul">data_total</span>[<span class="n">'Mjob'</span>] = <span
                  class="azul">data_total</span>[<span class="n">'Mjob'</span>].<span class="n">map</span>(
                <span class="azul">categorical_d</span>)
                <br>
                <span class="azul">data_total</span>[<span class="n">'Fjob'</span>] = <span
                  class="azul">data_total</span>[<span class="n">'Fjob'</span>].<span class="n">map</span>(
                <span class="azul">categorical_d</span>)
                <br>
                <br>
                <span class="azul">categorical_d</span> = {<span class="n">'home'</span>: <span class="verde">0</span>,
                <span class="n">'reputation'</span>: <span class="verde">1</span>, <span class="n">'course'</span>:
                <span class="verde">2</span>,<span class="n">'other'</span>: <span class="verde">3</span>}
                <br>
                <span class="azul">data_total</span>[<span class="n">'reason'</span>] = <span
                  class="azul">data_total</span>[<span class="n">'reason'</span>].<span class="n">map</span>(
                <span class="azul">categorical_d</span>)
                <br>
                <br>
                <span class="azul">categorical_d</span> = {<span class="n">'mother'</span>: <span
                  class="verde">0</span>,
                <span class="n">'father'</span>: <span class="verde">1</span>, <span class="n">'other'</span>: <span
                  class="verde">2</span>}
                <br>
                <span class="azul">data_total</span>[<span class="n">'guardian'</span>] = <span
                  class="azul">data_total</span>[<span class="n">'guardian'</span>].<span class="n">map</span>(
                <span class="azul">categorical_d</span>)
              </div>
              <p>
                Ahora podemos crear los conjuntos de datos y objetivos (X, y) para entrenar el modelo:
              </p>
              <div class="highlight">
                <span class="azul">X</span> = <span class="azul">data_total</span>.<span class="n">drop</span>(
                <span class="azul">'G3'</span>, <span class="n">axis</span>=<span class="verde">1</span>)
                <br>
                <span class="azul">y</span> = <span class="azul">data_total</span>[<span class="azul">'G3'</span>]
              </div>
              <p>
                De igual forma vamos a generar los conjuntos de entrenamiento y de pruebas:
              </p>
              <div class="highlight">
                <span class="azul">X_train</span>, <span class="azul">X_test</span>, <span class="azul">y_train</span>,
                <span class="azul">y_test</span> = <span class="azul">train_test_split</span>(<span
                  class="azul">X</span>,
                <span class="azul">y</span>, <span class="n">test_size</span>=<span class="verde">0.2</span>,
                <span class="n">random_state</span>=<span class="verde">0</span>)
              </div>
              <p>
                Ahora vamos a definir los modelos:
              </p>
              <div class="highlight">
                <span class="azul">svm_model</span> = <span class="verde">SVR</span>()
                <br>
                <span class="azul">rf_model</span> = <span class="verde">RandomForestRegressor</span>(<span
                  class="azul">n_estimators</span> = <span class="n">150</span>)
              </div>
              <p>
                Y ahora vamos a entrenarlos:
              </p>
              <div class="highlight">
                <span class="azul">svm_model</span>.<span class="n">fit</span>(<span class="azul">X_train</span>,
                <span class="azul">y_train</span>)
                <br>
                <span class="azul">rf_model</span>.<span class="n">fit</span>(<span class="azul">X_train</span>,
                <span class="azul">y_train</span>)
              </div>
              <p>
                Ahora vamos a predecir:
              </p>
              <div class="highlight">
                <span class="azul">pred_svm</span> = <span class="azul">svm_model</span>.<span class="n">predict</span>(
                <span class="azul">X_test</span>)
                <br>
                <span class="azul">pred_rf</span> = <span class="azul">rf_model</span>.<span class="n">predict</span>(
                <span class="azul">X_test</span>)
              </div>
              <p>
                Y ahora vamos a medir los resultados:
              </p>
              <div class="highlight">
                <span class="azul">score_svm_mse</span> = <span class="n">mean_squared_error</span>(<span
                  class="azul">y_test</span>,
                <span class="azul">pred_svm</span>)
                <br>
                <span class="azul">score_rf_mse</span> = <span class="n">mean_squared_error</span>(<span
                  class="azul">y_test</span>, <span class="azul">pred_rf</span>)
                <br>
                <br>
                <span class="azul">score_svm_mae</span> = <span class="n">mean_absolute_error</span>(<span
                  class="azul">y_test</span>,
                <span class="azul">pred_svm</span>)
                <br>
                <span class="azul">score_rf_mae</span> = <span class="n">mean_absolute_error</span>(<span
                  class="azul">y_test</span>, <span class="azul">pred_rf</span>)
              </div>
              <p>
                Y ahora vamos a comparar los resultados:
              </p>
              <div class="highlight">
                <span class="n">print</span>(<span class="azul">score_svm_mse</span>)
                <br>
                <span class="n">print</span>(<span class="azul">score_rf_mse</span>)
                <br>
                <span class="n">print</span>(<span class="azul">score_svm_mae</span>)
                <br>
                <span class="n">print</span>(<span class="azul">score_rf_mae</span>)
              </div>
              <p>
                Esos fueron los modelos de aprendizaje automático, sin embargo, existe una forma un poco más profunda de
                generar las predicciones. Vamos a realizar una red neuronal para este análisis:
              </p>
              <div class="highlight">
                <span class="azul">nn_model</span> = <span class="azul">keras</span>.<span class="n">Sequential</span>([
                <br>
                <span class="n">layers</span>.<span class="n">Dense</span>(<span class="n">64</span>, <span
                  class="n">activation</span>=<span class="azul">'relu'</span>),
                <br>
                <span class="n">layers</span>.<span class="n">Dense</span>(<span class="n">64</span>, <span
                  class="n">activation</span>=<span class="azul">'relu'</span>),
                <br>
                <span class="n">layers</span>.<span class="n">Dense</span>(<span class="n">1</span>)
                <br>
                ])
              </div>
              <p>
                Vamos a compilar este modelo con un optimizador y una función de pérdida:
              </p>
              <div class="highlight">
                <span class="azul">nn_model</span>.<span class="n">compile</span>(<span
                  class="azul">optimizer</span>=<span class="n">'rmsprop'</span>,
                <span class="azul">loss</span>=<span class="n">'mse'</span>, <span class="azul">metrics</span>=[
                <span class="n">'mae'</span>])
              </div>
              <p>
                Y ahora vamos a entrenarlo:
              </p>
              <div class="highlight">
                <span class="azul">history</span> =
                <span class="azul">nn_model</span>.<span class="n">fit</span>(<span class="azul">X_train</span>,
                <span class="azul">y_train</span>, <span class="azul">epochs</span>=<span class="n">100</span>,
                <span class="azul">validation_split</span>=<span class="n">0.2</span>)
              </div>
              <p>
                Vamos a ver los resultados en un gráfico:
              </p>
              <div class="highlight">
                <span class="azul">plt</span>.<span class="n">plot</span>(<span class="azul">history</span>.<span
                  class="n">history</span>[<span class="azul">'mae'</span>])
                <br>
                <span class="azul">plt</span>.<span class="n">plot</span>(<span class="azul">history</span>.<span
                  class="n">history</span>[<span class="azul">'val_mae'</span>])
                <br>
                <span class="azul">plt</span>.<span class="n">title</span>(<span class="azul">'model mae'</span>)
                <br>
                <span class="azul">plt</span>.<span class="n">ylabel</span>(<span class="azul">'mae'</span>)
                <br>
                <span class="azul">plt</span>.<span class="n">xlabel</span>(<span class="azul">'epoch'</span>)
                <br>
                <span class="azul">plt</span>.<span class="n">legend</span>(<span class="azul">['train', 'test'],
                  <span class="azul">loc</span>=<span class="azul">'upper left'</span>)
                  <br>
                  <span class="azul">plt</span>.<span class="n">show</span>()
              </div>
              <p>
                Y ahora vamos a predecir:
              </p>
              <div class="highlight">
                <span class="azul">pred_nn</span> = <span class="azul">nn_model</span>.<span
                  class="n">predict</span>(<span class="azul">X_test</span>)
              </div>
              <p>
                Revisemos los resultados:
              </p>
              <div class="highlight">
                <span class="azul">score_nn_mae</span> = <span class="n">mean_absolute_error</span>(<span
                  class="azul">y_test</span>, <span class="azul">pred_nn</span>)
                <br>
                <span class="azul">score_nn_mse</span> = <span class="n">mean_squared_error</span>(<span
                  class="azul">y_test</span>, <span class="azul">pred_nn</span>)
              </div>
              <p>
                Y ahora vamos a imprimir los resultados:
              </p>
              <div class="highlight">
                <span class="n">print</span>(<span class="azul">score_nn_mae</span>)
                <br>
                <span class="n">print</span>(<span class="azul">score_nn_mse</span>)
              </div>
              <p>
                Si lo has hecho bien, verás que el mejor modelo (menor error absoluto) es el de Random Forest, por esta
                razón puede ser útil revisar modelos basados en árboles (si se quiere reducir más el error) como el caso
                del XGboost.
              </p>
              <p>
                Por lo pronto, hasta aquí llega este tutorial. Si deseas ver los resultados del código y comparar tus
                resultados, busca el enlace más abajo. Para entender lo que hemos realizado te sugiero el curso de
                aprendizaje profundo. ¡Suerte!
              </p>
            </div>
          </div>

          <!-- aquí empieza la parte de ejercicios o material descargable -->

          <div class="form-comments">
            <div class="title-box-2">
              <h3 class="title-left">
                Material descargable
              </h3>
            </div>
            <div class="more-info">
              <li>
                <a href="material-tutoriales\calificaciones-de-matematicas.csv">Datos para el análisis</a>
              </li>
              <li>
                <a href="material-tutoriales\post1.ipynb">Código ejemplo</a>
              </li>
              <li>
                <a href="https://drive.google.com/file/d/1ryJbsa6KgnwhVdZpczJgWQoIikjneiKW/view?usp=sharing">Código ejemplo (en línea - colab)</a>
              </li>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="widget-sidebar sidebar-search">
            <h5 class="sidebar-title">Curso de aprendizaje profundo</h5>
          </div>
          <div class="widget-sidebar">
            <h5 class="sidebar-title">Mas lecturas del curso</h5>
            <div class="sidebar-content">
              <ul class="list-sidebar">
                <li>
                  <a href="blog-single.html#blog">¿Qué es el aprendizaje profundo?<p>(Lectura 1)</p></a>
                </li>
                <li>
                  <a href="blog-single2.html#blog">Una breve historia del aprendizaje automático<p>(Lectura 2)</p></a>
                </li>
                <li>
                  <a href="#">Un primer vistazo a una red neuronal<p>(Lectura 4)</p></a>
                </li>
                <li>
                  <a href="#">Representaciones de datos para redes neuronales<p>(Lectura 5)</p></a>
                </li>
                <li>
                  <a href="#">Los engranajes de las redes neuronales<p>(Lectura 6)</p></a>
                </li>
              </ul>
            </div>
          </div>
          <div class="widget-sidebar">
            <h5 class="sidebar-title">Otros post</h5>
            <div class="sidebar-content">
              <ul class="list-sidebar">
                <li>
                  <a href="#">September, 2017.</a>
                </li>
                <li>
                  <a href="#">April, 2017.</a>
                </li>
                <li>
                  <a href="#">Nam quo autem exercitationem.</a>
                </li>
                <li>
                  <a href="#">Atque placeat maiores nam quo autem</a>
                </li>
                <li>
                  <a href="#">Nam quo autem exercitationem.</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!--/ Section Blog-Single End /-->

  <!--/ Section Contact-Footer Star /-->
  <section class="paralax-mf footer-paralax bg-image sect-mt4 route" style="background-image: url(img/overlay-bg.jpg)">
    <div class="overlay-mf"></div>
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-sm-12">
            <div class="copyright-box">
              <p class="copyright">&copy; Copyright <strong>Christian Altamirano</strong>. Gracias por visitar</p>
              <div class="credits">
                «<a href="https://github.com/crisdavid3335">¿Heredarán los robots la Tierra? Sí, pero serán nuestros
                  hijos»</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>
  </section>
  <!--/ Section Contact-footer End /-->

  <a href="#" class="back-to-top"><i class="fa fa-chevron-up"></i></a>
  <div id="preloader"></div>

  <!-- JavaScript Libraries -->
  <script src="lib/jquery/jquery.min.js"></script>
  <script src="lib/jquery/jquery-migrate.min.js"></script>
  <script src="lib/popper/popper.min.js"></script>
  <script src="lib/bootstrap/js/bootstrap.min.js"></script>
  <script src="lib/easing/easing.min.js"></script>
  <script src="lib/counterup/jquery.waypoints.min.js"></script>
  <script src="lib/counterup/jquery.counterup.js"></script>
  <script src="lib/owlcarousel/owl.carousel.min.js"></script>
  <script src="lib/lightbox/js/lightbox.min.js"></script>
  <script src="lib/typed/typed.min.js"></script>
  <!-- Contact Form JavaScript File -->
  <script src="contactform/contactform.js"></script>

  <!-- Template Main Javascript File -->
  <script src="js/main.js"></script>

</body>

</html>